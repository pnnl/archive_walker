<?xml version="1.0" encoding="UTF-8" ?>
<Config>
    <DataConfig>
        <Configuration>
            <ReaderProperties>
                <!--
            <FileDirectory>D:\BAWS\BAWS_GIT\DataReaderCode\OriginalData</FileDirectory>
            -->
                <!--
            <FileDirectory> D:\BAWS\BAWS_GIT_FY17\code\DataReaderCode\OriginalData</FileDirectory>
            -->
                <FileDirectory>E:\Alberta tie in-out\Munro</FileDirectory>
                <FileType>PDAT</FileType>
                <Mnemonic>WISPMunro</Mnemonic>
                <!--
            -->
                <Mode>
                    <Name>Archive</Name>
                    <Params>
                        <DateTimeStart>2016-08-21 00:00:00 GMT</DateTimeStart>
                        <DateTimeEnd>2016-08-24 23:59:00 GMT</DateTimeEnd>
                    </Params>
                </Mode>
            </ReaderProperties>
            <!-- 
        Each stage is composed of data quality filters and customizations. 
        Filters are always applied first, then the customizations. The 
        stages are carried out in sequential order. 

        For all filters, if PMU isn't included, the filter is applied to all 
        PMUs. Under PMU, if Channel isn't included, the filter is applied for
        all appropriate channels in the specified PMUs. 
        -->
            <!--
        *******
        Stage 1
        *******
        -->
            <Stages>
                <!--
            **********************
            Stage 1 - DQ Filtering
            **********************
            -->
                <Filter>
                    <Name>DropOutZeroFilt</Name>
                    <Parameters>
                        <SetToNaN>TRUE</SetToNaN>
                        <FlagBit>2</FlagBit>
                    </Parameters>
                    <PMU>
                        <Name>BGED 500  B1 SA </Name>
                    </PMU>
                    <PMU>
                        <Name>JDAY 500  B1 SA </Name>
                    </PMU>
                    <PMU>
                        <Name>MALN 500  B1 SA </Name>
                    </PMU>
                </Filter>
                <Filter>
                    <Name>VoltPhasorFilt</Name>
                    <Parameters>
                        <VoltMin>0.7</VoltMin>
                        <VoltMax>1.3</VoltMax>
                        <SetToNaN>TRUE</SetToNaN>
                        <FlagBit>4</FlagBit>
                    </Parameters>
                    <PMU>
                        <Name>BGED 500  B1 SA </Name>
                    </PMU>
                    <PMU>
                        <Name>JDAY 500  B1 SA </Name>
                    </PMU>
                    <PMU>
                        <Name>MALN 500  B1 SA </Name>
                    </PMU>
                </Filter>
                <Filter>
                    <Name>StaleFilt</Name>
                    <Parameters>
                        <FlagAllByFreq>FALSE</FlagAllByFreq>
                        <StaleThresh>60</StaleThresh>
                        <SetToNaN>TRUE</SetToNaN>
                        <FlagBit>8</FlagBit>
                        <FlagBitFreq>9</FlagBitFreq>
                    </Parameters>
                    <PMU>
                        <Name>BGED 500  B1 SA </Name>
                    </PMU>
                    <PMU>
                        <Name>JDAY 500  B1 SA </Name>
                    </PMU>
                    <PMU>
                        <Name>MALN 500  B1 SA </Name>
                    </PMU>
                </Filter>
                <Customization>
                    <Name>Subtraction</Name>
                    <Parameters>
                        <SignalName>JDAY to MALN</SignalName>
                        <minuend>
                            <PMU>JDAY 500  B1 SA </PMU>
                            <Channel>JDAY 500  B1 SA .B500EAST_____1VP.ANG</Channel>
                        </minuend>
                        <subtrahend>
                            <PMU>MALN 500  B1 SA </PMU>
                            <Channel>MALN 500  B1 SA .B500NORTH____1VP.ANG</Channel>
                        </subtrahend>
                    </Parameters>
                </Customization>
                <Customization>
                    <Name>Subtraction</Name>
                    <Parameters>
                        <SignalName>BGED to MALN</SignalName>
                        <minuend>
                            <PMU>BGED 500  B1 SA </PMU>
                            <Channel>BGED 500  B1 SA .B500WEST_____1VP.ANG</Channel>
                        </minuend>
                        <subtrahend>
                            <PMU>MALN 500  B1 SA </PMU>
                            <Channel>MALN 500  B1 SA .B500NORTH____1VP.ANG</Channel>
                        </subtrahend>
                    </Parameters>
                </Customization>
            </Stages>
            <SignalSelection>
                <PMU>
                    <Name>Custom Signals</Name>
                </PMU>
            </SignalSelection>
        </Configuration>
    </DataConfig>
    <!--
****
****
    -->
    <ProcessConfig>
        <Configuration>
            <InitializationPath>C:\Users\foll154\Documents\BPAoscillationApp\CodeForProject2\DataReaderCode\Initialization\</InitializationPath>
            <Processing>
                <!--
            For interpolation, filtering, and sampling-rate conversion, if the 
            PMU element is omitted the process is applied to all signals in all
            PMUs. If the Channels element within a PMU element is omitted the 
            process is applied to all signals in that PMU. Otherwise, the 
            process is applied to the specific PMUs and signals listed in the
            elements.
            If channels are not specified for wrap and unwrap operations, they
            are applied to all angle signals in the PMUs.
            -->
                <Unwrap>
                    <MaxNaN>1</MaxNaN>
                </Unwrap>
                <Interpolate>
                    <Parameters>
                        <Limit>100</Limit>
                        <Type>Linear</Type>
                        <FlagInterp>TRUE</FlagInterp>
                    </Parameters>          
                </Interpolate>
                <Stages>
                    <Filter>
                        <Type>Rational</Type>
                        <Parameters>
                            <Numerator>1/6,-1/6</Numerator>
                            <Denominator>1</Denominator>
                            <ZeroPhase>FALSE</ZeroPhase>
                        </Parameters>
                    </Filter>
                    <Multirate>
                        <Parameters>
                            <MultiRatePMU>DownsampledPMU</MultiRatePMU>
                            <NewRate>5</NewRate>
                        </Parameters>
                    </Multirate>
                </Stages>
                <Stages>
                    <Filter>
                        <PMU>
                            <Name>DownsampledPMU</Name>
                        </PMU>
                        <Type>HighPass</Type>
                        <Parameters>
                            <Order>1</Order>
                            <Cutoff>0.1</Cutoff>
                            <ZeroPhase>FALSE</ZeroPhase>
                        </Parameters>
                    </Filter>
                </Stages>
            </Processing>   
            <NameTypeUnit>
                <NewUnit>Hz</NewUnit>
                <NewType>F</NewType>
            </NameTypeUnit>
            <!--
        Specify the signals for output
        -->
            <SignalSelection>
                <PMU>
                    <Name>DownsampledPMU</Name>
                </PMU>
            </SignalSelection>
        </Configuration>
    </ProcessConfig>
    <!--
****
****
    -->
    <DetectorConfig>
        <Configuration>
            <!-- Channels are specified identically for all detectors. If no PMU 
        element is included, all channels from all PMUs are included. If Channel 
        elements are not included within a PMU element, all channels for 
        the specified PMU are included. Otherwise, only the specified 
        channels are included in the analysis. Examples of the latter two cases
        are given below rather than within each of the detector elements.
        <PMU>
            <Name>JDAY 500  A1 SA </Name>
        </PMU>
        <PMU>
            <Name>ALSN 500 A1 SA  </Name>
            <Channel>
                <Name>ALSN 500 A1 SA  .B500NORTH____1VP.MAG</Name>
            </Channel>
            <Channel>
                <Name>ALSN 500 A1 SA  .B500NORTH____1VP.ANG</Name>
            </Channel>
        </PMU>
        -->
            <EventPath>C:\Users\foll154\Documents\BPAoscillationApp\CodeForProject2\DataReaderCode\EventList\EventXML</EventPath>
            <ResultUpdateInterval>60</ResultUpdateInterval>
            <!-- Forced Oscillation detector -->
            <Periodogram>
                <!-- Mode of operation. Options are SingleChannel and MultiChannel.
            If omitted, default is single channel.-->
                <Mode>MultiChannel</Mode>
                <!-- Number of seconds of data to use in the analysis. Not optional.
            -->
                <AnalysisLength>600</AnalysisLength>
                <!-- Type of window used for the test statistic periodogram, 
            Daniell-Welch periodogram, and GMSC. Options are rectwin (rectangular), 
            bartlett, hann, hamming, and blackman. If omitted, default is hann. -->
                <WindowType>hamming</WindowType>
                <!-- This is the frequency interval in Hz for the test statistic periodogram,
            Daniell-Welch periodogram, and GMSC. It corresponds to the sampling
            rate divided by the zero-padded length of each of these spectrums.
            If omitted, it defaults to the sampling rate divided by the number
            of samples corresponding to AnalysisLength, i.e., no zero padding 
            is implemented. -->
                <FrequencyInterval>0.00125</FrequencyInterval>
                <!-- Length of the sections for the Daniell-Welch periodogram and 
            GMSC in seconds. If omitted, default is 1/3 of AnalyisLength. -->
                <WindowLength>200</WindowLength>
                <!-- Amount of overlap between sections for the Daniell-Welch 
            periodogram and GMSC in seconds. If omitted, default is half of 
            WindowLength -->
                <WindowOverlap>100</WindowOverlap>
                <!-- Frequency width corresponding to the frequency-domain median 
            filter used in the Daniell-Welch periodogram. This width is equal 
            to the median filter's order times the FrequencyInterval entry. If 
            omitted, the default corresponds to a filter order such that: it is 
            the smallest odd integer greater 
            than or equal to three times the main lobe width of the applied 
            window. If an even number, a number less than 3, or a non-integer 
            would result for the filter order, the smallest odd integer greater 
            than or equal to 3
            and the order resulting from specified value will be used. -->
                <MedianFilterFrequencyWidth>0.04625</MedianFilterFrequencyWidth>
                <!-- Probability of false alarm. With zero padding it becomes a 
            maximum. If omitted, the default of 0.01 is used. -->
                <Pfa>0.05</Pfa>
                <!-- Minimum frequency to be considered. If omitted, the default is
            zero, but in many cases this will cause excessive false alarms. -->
                <FrequencyMin>0.1</FrequencyMin>
                <!-- Maximum frequency to be considered. If omitted, the default is
            the Nyquist frequency -->
                <FrequencyMax>1.5</FrequencyMax>
                <!-- Tolerance used to refine the frequency estimate.
            If omitted, the default is the greater of 1) the main lobe 
            width of the test statistic periodogram's window and 2) half of 
            FrequencyMin. -->
                <FrequencyTolerance>0.05</FrequencyTolerance>
                <!-- Select channels for analysis -->
                <PMU>
                    <Name>DownsampledPMU</Name>
                    <Channel>
                        <Name>JDAY to MALN</Name>
                    </Channel>
                    <Channel>
                        <Name>BGED to MALN</Name>
                    </Channel>
                </PMU>
            </Periodogram>
            <!--
            -->
            <Periodogram>
                <!-- Mode of operation. Options are SingleChannel and MultiChannel.
            If omitted, default is single channel.-->
                <Mode>MultiChannel</Mode>
                <!-- Number of seconds of data to use in the analysis. Not optional.
            -->
                <AnalysisLength>1200</AnalysisLength>
                <!-- Type of window used for the test statistic periodogram, 
            Daniell-Welch periodogram, and GMSC. Options are rectwin (rectangular), 
            bartlett, hann, hamming, and blackman. If omitted, default is hann. -->
                <WindowType>rectwin</WindowType>
                <!-- This is the frequency interval in Hz for the test statistic periodogram,
            Daniell-Welch periodogram, and GMSC. It corresponds to the sampling
            rate divided by the zero-padded length of each of these spectrums.
            If omitted, it defaults to the sampling rate divided by the number
            of samples corresponding to AnalysisLength, i.e., no zero padding 
            is implemented. -->
                <FrequencyInterval>0.000625</FrequencyInterval>
                <!-- Probability of false alarm. With zero padding it becomes a 
            maximum. If omitted, the default of 0.01 is used. -->
            <!-- This is the frequency interval in Hz for the test statistic periodogram,
            Daniell-Welch periodogram, and GMSC. It corresponds to the sampling
            rate divided by the zero-padded length of each of these spectrums.
            If omitted, it defaults to the sampling rate divided by the number
            of samples corresponding to AnalysisLength, i.e., no zero padding 
            is implemented. -->
                <Pfa>0.05</Pfa>
                <!-- Minimum frequency to be considered. If omitted, the default is
            zero, but in many cases this will cause excessive false alarms. -->
                <FrequencyMin>0.1</FrequencyMin>
                <!-- Maximum frequency to be considered. If omitted, the default is
            the Nyquist frequency -->
                <FrequencyMax>1.5</FrequencyMax>
                <!-- Select channels for analysis -->
                <PMU>
                    <Name>DownsampledPMU</Name>
                    <Channel>
                        <Name>JDAY to MALN</Name>
                    </Channel>
                    <Channel>
                        <Name>BGED to MALN</Name>
                    </Channel>
                </PMU>
            </Periodogram>
            <!--
            -->
            <Periodogram>
                <!-- Mode of operation. Options are SingleChannel and MultiChannel.
            If omitted, default is single channel.-->
                <Mode>MultiChannel</Mode>
                <!-- Number of seconds of data to use in the analysis. Not optional.
            -->
                <AnalysisLength>400</AnalysisLength>
                <!-- Type of window used for the test statistic periodogram, 
            Daniell-Welch periodogram, and GMSC. Options are rectwin (rectangular), 
            bartlett, hann, hamming, and blackman. If omitted, default is hann. -->
                <WindowType>rectwin</WindowType>
                <!-- This is the frequency interval in Hz for the test statistic periodogram,
            Daniell-Welch periodogram, and GMSC. It corresponds to the sampling
            rate divided by the zero-padded length of each of these spectrums.
            If omitted, it defaults to the sampling rate divided by the number
            of samples corresponding to AnalysisLength, i.e., no zero padding 
            is implemented. -->
                <FrequencyInterval>0.00125</FrequencyInterval>
                <!-- Probability of false alarm. With zero padding it becomes a 
            maximum. If omitted, the default of 0.01 is used. -->
                <Pfa>0.05</Pfa>
                <!-- Minimum frequency to be considered. If omitted, the default is
            zero, but in many cases this will cause excessive false alarms. -->
                <FrequencyMin>0.1</FrequencyMin>
                <!-- Maximum frequency to be considered. If omitted, the default is
            the Nyquist frequency -->
                <FrequencyMax>1.5</FrequencyMax>
                <!-- Select channels for analysis -->
                <PMU>
                    <Name>DownsampledPMU</Name>
                    <Channel>
                        <Name>JDAY to MALN</Name>
                    </Channel>
                    <Channel>
                        <Name>BGED to MALN</Name>
                    </Channel>
                </PMU>
            </Periodogram>
            <!-- Alarming info (not needed for ringdowns) -->
            <Alarming>
            </Alarming>
        </Configuration>
    </DetectorConfig>
</Config>